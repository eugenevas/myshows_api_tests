
<h1 align="center">Описание проекта</h1>


<br> My Shows - это копия одноименного сервиса https://myshows.me/

Можно вести список сериалов, которые смотришь сейчас или когда-то смотрел.
Этот проект представляет из себя сервис для ведения рейтинга сериалов. Он состоит из микросервиса, nginx и базы Postgres, всё это связано с помощью docker compose и может быть одной командой развёрнуто локально.




# Архитектура проекта
<br> База данных PostgreSQL
<br>Бэкенд написан на Python
<br>REST API
<br>Веб-сервер Nginx


# Что нужно сделать, чтобы проект запустить локально
<br>1. Установить Docker
<br>2. Поднять проект локально из Docker образа
<br>3. Подключиться к базе данных


# Описание классов, методов и фикстур
**config:**
<br>•api_config.py - эндпоинты.
<br>•bd_config.py - здесь происходит коннект к БД.
<br>**data:**
<br>•delete_series.sql - удаляет сериал через SQL скрипт.
<br>•insert_series.sql - добаляет сериал через SQL скрипт.
<br>•series_for_testing.py - массив сериалов для добавления.
<br>**fixtures:**
<br>•api_fixtures.py - фикстура для подготовки данных для теста.
<br>•settings_db()- фикстура конфигурации
<br>•api_session() - фикстура api_session
<br>•add_series_in_db() - фикстура для добавления сериалов в базу (через SQL)
<br>•add_series_via_api(api_session) - фикстура для добавления сериалов через API (посылает POST-запросы)
<br>**helpers:**
<br>•api_helpers.py - класс для создания сессии
<br>•db_helpers.py - класс DbConnection для создания соединения с БД
<br>•db_mapping.py - маппит статус сериала 
<br>**tests:**
<br>•tests_myshows.py - тесты
<br>•class TestGetEndpoint - метод test_write_series_in_bd_get_episode() проверяет приходят ли добавленные сериалы.
<br>•Сериалы добавляются с помощью psycopg.


# Тесты в проекте
<br>**Метод GET**
<br>1. Фикстура add_series_in_db подключается к БД напрямую через psycopg, очищает таблицу series, добавляет три записи с нужными статусами (переведёнными в базовое значение).
<br>2. После теста таблица очищается.
<br>3. Тест test_write_series_in_bd_get_episode делает запрос к API, получает JSON-список, сравнивает полученные сериалы с теми, что были добавлены.
<br>4. Важный момент — статус в API и в базе различается, поэтому при добавлении и проверке применяется словарь API_SERIES_STATUS_TO_DB_MAPPING.
<br>5. Предполагается, что API возвращает статус в формате API (т.е. на русском, как в expected_series).
<br>**Метод PUT**
<br>6. Для каждого поля в FIELDS_TO_TEST делается отдельный тест.
<br>7. В тесте отправляется PUT-запрос с обновлённым полем.
<br>8. После запроса происходит проверка значения в базе.
<br>9. В фикстуре создаётся сериал, после теста — удаляется.
